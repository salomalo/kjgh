if(jQuery(function(o){function e(e){return body=parseInt(o("body").css(e)||0),html=parseInt(o("html").css(e)||0),body+html}o(document).on("eboxInit",function(){$mats=o(".rstboxes .eb-pageslide"),$mats.length&&($mats.each(function(e,t){$mat=o(t),$mat.css({height:$mat.css("height")}),$mat.on("beforeOpen",function(){window.scrollTo(0,0)}),$mat.on("afterOpen",function(){o("html").addClass("eboxWelcomeMat")}).on("afterClose",function(){o("html").removeClass("eboxWelcomeMat")})}),o("<div>").addClass("rstboxes eboxWelcomeMats").prependTo("body").css({margin:[-(e("padding-top")+e("margin-top")+e("border-top-width")),-(e("padding-right")+e("margin-right")+e("border-right-width")),0,-(e("padding-left")+e("margin-left")+e("border-left-width"))].join("px ")+"px"}),$mats.appendTo(o("body .eboxWelcomeMats")))})}),void 0===rstbox)var rstbox={};void 0===rstbox.jQuery&&(rstbox.jQuery=jQuery.noConflict()),function(h){h(document).ready(function(){var t="[RSTBox]",e=h(".rstboxes").last();if(e.children().length){var s="rstbox_"+e.data("site")+"_",b=(h(window).height(),h(document).height(),e.data("debug"));h("*[data-ebox], *[data-ebox-cmd]").on("click",function(e){if(boxID=parseInt(h(this).data("ebox")),box=boxID?h(".rstboxes > #rstbox_"+boxID).first():h(this).closest("div.rstbox"),box){switch(h(this).data("ebox-cmd")){case"open":box.trigger("open");break;case"close":box.trigger("close");break;case"closeKeep":box.trigger("closeKeep");break;default:box.is(":visible")?box.trigger("close"):box.trigger("open")}"0"!=h(this).data("ebox-prevent")&&e.preventDefault()}}),h("*[data-rstbox], *[data-rstbox-command], *[data-rstbox-cmd]").on("click",function(e){if(boxID=parseInt(h(this).data("rstbox")),boxID?box=h(".rstboxes > #rstbox_"+boxID).first():box=h(this).closest("div.rstbox"),box){var t=h(this).data("rstbox-cmd");switch(boxCommand=void 0!==t&&!1!==t?t:h(this).data("rstbox-command"),boxCommand){case"open":box.trigger("open");break;case"close":box.trigger("close");break;case"closeKeep":box.trigger("closeKeep");break;default:box.is(":visible")?box.trigger("close"):box.trigger("open")}"0"!=h(this).data("rstbox-prevent")&&e.preventDefault()}}),e.find("> .rstbox").each(function(){var n=h(this),i=n.attr("id").replace("rstbox_",""),e=0,t=n.data("trigger").split(":")[0],o="pageload"!=t&&n.data("trigger").split(":")[1],r=v(i),a="1"==x(n,"testmode",0);if(n.on("open",function(){y(n,!0)}),n.on("close",function(){y(n,!1)}),n.on("closeKeep",function(){!function(e){y(e,!1),a||(cookieType=e.data("cookietype"),"session"==cookieType&&(m(i,"session"),p("Box "+i+" Session cookie set")),"ever"==cookieType&&(m(i,"ever"),p("Box "+i+" Cookie set for ever")),"seconds"!=cookieType&&"minutes"!=cookieType&&"days"!=cookieType&&"hours"!=cookieType||(cook=parseInt(e.data("cookietime")),0<cook&&(m(i,e.data("cookietype"),cook),p("Box "+i+" Cookie set for "+cook+" "+e.data("cookietype")))))}(n)}),n.on("setCookie",function(e,t,o){m(i,t,o)}),n.on("beforeOpen",function(){ovrl=x(n,"overlay"),ovrl&&(h("#overlay_rstbox_"+i).length||(overlay=ovrl.split(":"),overlayObject=h("<div/>",{id:"overlay_"+n.attr("id"),class:"rstbox_overlay",css:{"background-color":overlay[0]}}).insertAfter(n),overlayClick=parseInt(overlay[1]),overlayClick&&overlayObject.on("click",function(){n.trigger("closeKeep")}),n.on("beforeClose",function(){n.next(".rstbox_overlay").remove()})))}),n.on("beforeOpen",function(){parseInt(x(n,"preventpagescroll",0))&&h("html").addClass("eboxPageNoScroll")}),n.on("afterOpen",function(){n.addClass("rstbox_visible"),h("body").addClass(n.attr("id")),p("Box "+i+" opened")}),n.on("afterClose",function(){n.removeClass("rstbox_visible"),h("body").removeClass(n.attr("id")),h("html").removeClass("eboxPageNoScroll"),p("Box "+i+" closed")}),a&&p("Box "+i+" is on test mode"),!r||a){if("element"==t){if(0==(u=h(o).filter(":first")).length)return void p("Box "+i+" Can't find element \""+o+'". Not showing box.');var s="load resize scroll.box"+parseInt(i),l=0!=parseInt(x(n,"autohide",0));(c=function(){v(i)||(e&&clearTimeout(e),e=window.setTimeout(function(){!function(e){"function"==typeof jQuery&&e instanceof jQuery&&(e=e[0]);var t=e.getBoundingClientRect();return 0<=t.top&&0<=t.left&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}(u)?y(n,!1):(l||h(window).off(s,c),y(n,!0))},50))})(),h(window).on(s,c),n.on("afterClose",function(){v(i)&&(p("Box "+i+" Unbinding Scroll Check"),h(window).off(s,c))})}if("pageheight"==t){s="load resize scroll.box"+parseInt(i),l=0!=parseInt(x(n,"autohide",0));var c,d=parseInt(o);p("Box "+i+" is going to be triggered on "+d+"% of page height."),(c=function(){v(i)||(e&&clearTimeout(e),e=window.setTimeout(function(){var e=h(window).scrollTop(),t=h(document).height(),o=h(window).height();d<e/(t-o)*100?(l||h(window).off(s,c),n.is(":visible")||y(n,!0)):n.is(":visible")&&l&&y(n,!1)},50))})(),h(window).on(s,c),n.on("afterClose",function(){v(i)&&h(window).off(s,c)})}if("userleave"==t&&(p("Box "+i+" is going to be triggered on user leave"),h(document).ExitIntent({timer:x(n,"exittimer",1e3),debug:b,callback:function(){v(i)||y(n,!0)}})),"pageready"==t){if(v(i))return;p("Box "+i+" is going to be triggered at page ready"),y(n,!0)}if("pageload"==t&&h(window).on("load",function(){v(i)||(p("Box "+i+" is going to be triggered at page load"),y(n,!0))}),"elementHover"==t){var u=h(o),f=x(n,"delay",30);0==u.length?p("Box "+i+" Can't find element \""+o+'". Not showing box.'):(p("Box "+i+" will be trigger at "+o+"hover"),u.on({mouseover:function(){e=setTimeout(function(){v(i)||y(n,!0)},f)},mouseout:function(){clearTimeout(e)}}),n.on("afterClose",function(){v(i)&&(p("Box "+i+" Unbinding MouseOver & MouseOut events"),u.off("mouseover mouseout"))}))}if("onclick"==t)0==!(u=h(x(n,"triggerelement"))).length&&(u.on("click",function(e){v(i)||(y(n,!0),0<parseInt(x(n,"triggerpreventdefault","1"))&&e.preventDefault())}),p("Box "+i+" will be triggered on click"));"ondemand"==t&&p("Box "+i+" will be triggered on demand");var g=x(n,"autoclose",0);0<g&&(p("Box "+i+" will be auto-closed after "+g+" miliseconds"),n.on("afterOpen",function(){setTimeout(function(){n.trigger("closeKeep")},g)})),0<parseInt(x(n,"closeopened",0))&&n.on("beforeOpen",function(){h(".rstbox").trigger("close")}),n.on("afterOpen",function(){n.get(0).focus()})}else p("Box "+i+" is hidden by cookie")}),h(document).trigger("eboxInit",[e])}else console.log(t+" Can't find any boxes on this page. Exiting..");function p(e){e&&b&&(console=window.console||{log:function(){}},console.log(t+" "+e))}function x(e,t,o){if(t&&(obj=e.data("settings"),obj)){for(var n=t.split(".");n.length&&(obj=obj[n.shift()]););return"undefined"==typeof obj&&void 0!==o?o:obj}}function m(e,t,o){var n="";if("session"!=t){var i,r=new Date,a=r.getTime();switch(t){case"days":i=24*o*60*60;break;case"hours":i=60*o*60;break;case"minutes":i=60*o;break;case"seconds":i=o;break;case"ever":i=31536e4;break;case"remove":i=-1}r.setTime(a+1e3*i);n="; expires="+r.toGMTString()}document.cookie=s+e+"=true"+n+"; path=/"}function v(e){for(var t=s+e+"=",o=document.cookie.split(";"),n=0;n<o.length;n++){for(var i=o[n];" "==i.charAt(0);)i=i.substring(1,i.length);if(0==i.indexOf(t))return i.substring(t.length,i.length)}return null}function y(o,n){var i=(i=o.attr("id")).replace("rstbox_","");if(void 0!==o)if(o.hasClass("triggering"))p("Box "+i+" is already triggered");else if(n&&o.is(":visible"))p("Box "+i+" is already opened");else{if(n||!o.is(":hidden")){p("Box "+i+" is going to "+(n?"open":"close")+"!");var e=x(o,"transitionin","fadeIn"),t=x(o,"transitionout","fadeOut"),r=n?e:t,a=n?x(o,"delay",0):0,s=x(o,"duration","400");return o.addClass("triggering"),o.velocity(r,{delay:a,duration:s,begin:function(e){var t=n?"beforeOpen":"beforeClose";o.trigger(t),h(document).trigger("eboxBefore"+t.replace("before",""),[i,o]),n&&-1<r.indexOf("callout.")&&o.css({display:"block",opacity:"1"})},complete:function(e){var t=n?"afterOpen":"afterClose";o.trigger(t),h(document).trigger("eboxAfter"+t.replace("after",""),[i,o]),o.removeClass("triggering")}}),n}p("Box "+i+" is already closed")}else p("Box "+i+" is not present in the current page.")}})}(rstbox.jQuery),function(n,e,t){var o="ExitIntent",i={sensitivity:0,timer:1e3,delay:0,aggressive:!1,callback:null,debug:!1},r=!1,a=null;function s(e,t){this.options=n.extend({},i,t);var o=this;setTimeout(function(){o.init()},o.options.timer)}s.prototype.init=function(){this.options;var o=this;this.log("Init after "+this.options.timer),n(t).on("mouseout.exitintent",function(e){var t=!e.relatedTarget&&!e.toElement&&e.clientY<50;t&&(a=setTimeout(function(){o.fire()},o.options.delay)),o.log("Event: mouseout, Pass: "+t)}),0<this.options.sensitivity&&n(t).on("mousemove.exitintent",function(e){e.clientY<=o.options.sensitivity&&(o.log("Event: MouseMove"+e.clientY),a=setTimeout(function(){o.fire()},o.options.delay))}),n(t).on("mouseenter.exitintent",function(e){o.log("Event: mouseenter"),o.cleartimer()})},s.prototype.cleartimer=function(){a&&(this.log("Clearing Timer"),clearTimeout(a),a=null)},s.prototype.fire=function(){r||(this.log("Fire!"+a),"function"==typeof this.options.callback&&this.options.callback.call(this),this.options.aggressive||this.stop())},s.prototype.log=function(e){this.options.debug&&console.log("[Exit Intent] "+e)},s.prototype.stop=function(){this.log("Destroy"),n(t).off("mousemove.exitintent"),n(t).off("mouseout.exitintent"),n(t).off("mouseenter.exitintent"),r=!0},n.fn[o]=function(e){return this.each(function(){n.data(this,"plugin_"+o)||n.data(this,"plugin_"+o,new s(this,e))})}}(jQuery,window,document),function(o){var n,i,r,a={LOG_PREFIX:"EngageBox Google Analytics Tracking",LOAD_GA:"Loading Google Analytics library",INVALID_GA_ID:"Please provide a valid Google Analytics ID",INVALID_CAT:"Please provide a valid Event category"};function s(e){n.data("debug")&&console.log(a.LOG_PREFIX+": "+e)}o(document).on("eboxInit",function(e,t){track=(n=t).data("tracking"),track&&(trackingInfo=track.split(":"),(i=trackingInfo[0])?(r=trackingInfo[1])?o(document).on("eboxAfterOpen eboxAfterClose",function(e,t,o){!function(t,o,n){!function(e){if("undefined"!=typeof gaBox)return gaBox(function(){e()});s(a.LOAD_GA),function(e,t,o,n,i,r,a){e.GoogleAnalyticsObject=i,e[i]=e[i]||function(){(e[i].q=e[i].q||[]).push(arguments)},e[i].l=1*new Date,r=t.createElement("script"),a=t.getElementsByTagName("script")[0],r.async=1,r.src="//www.google-analytics.com/analytics.js",a.parentNode.insertBefore(r,a)}(window,document,0,0,"gaBox"),gaBox("create",i,"auto"),gaBox("require","displayfeatures"),gaBox(function(){e()})}(function(){var e="Box #"+o+" - "+n.data("title");gaBox("send","event",{eventCategory:r,eventAction:t,eventLabel:e,hitCallback:function(){s(t+" "+e)}})})}(e.type.replace("eboxAfter",""),t,o)}):s(a.INVALID_CAT):s(a.INVALID_GA_ID))})}(jQuery),function(n){var i,r={LOG_PREFIX:"EngageBox Event Logging",NO_BOXES_FOUND:"No boxes found. Abort",SUCCESS:"Success",FAIL:"Fail",GENERAL_ERROR:"General Error - Make sure your browser accepts cookies!",DISABLED:"Is disabled",INITIALIZED:"Plugin initialized successfully"};function a(e){i.data("debug")&&console.log(r.LOG_PREFIX+": "+e)}n(document).on("eboxAfterOpen",function(e,t,o){boxSettings=o.data("settings"),disableLog=0==parseInt(boxSettings.log),testMode=1==parseInt(boxSettings.testmode),testMode||disableLog||function(e,t){i=n(".rstboxes").last();var o={plugin:"rstbox",task:"track"};o.box=t,o.event=e,o[i.data("t")]=1,n.ajax({type:"POST",url:i.data("baseurl")+"index.php?option=com_ajax&format=raw",data:o,async:!0,dataType:"json",success:function(e){var t=e.status,o="Event #"+e.eventid+" - Box #"+e.box;a(t?r.SUCCESS+":"+o:r.FAIL+":"+o)},error:function(){a(r.GENERAL_ERROR)}})}(1,t)})}(jQuery),function(e){"function"==typeof e.Velocity.RegisterEffect&&(e.Velocity.RegisterEffect("rstbox.slideUpIn",{defaultDuration:450,calls:[[{translateY:"100%",opacity:1},.05],[{translateY:0},.95]]}),e.Velocity.RegisterEffect("rstbox.slideUpOut",{defaultDuration:450,calls:[[{translateY:"100%"},.95],[{opacity:0},.05]]}),e.Velocity.RegisterEffect("rstbox.slideDownIn",{defaultDuration:450,calls:[[{translateY:"-100%",opacity:1},.05],[{translateY:0},.95]]}),e.Velocity.RegisterEffect("rstbox.slideDownOut",{defaultDuration:450,calls:[[{translateY:"-100%"},.95],[{opacity:0},.05]]}),e.Velocity.RegisterEffect("rstbox.slideLeftIn",{defaultDuration:450,calls:[[{translateX:"-100%",opacity:1},.05],[{translateX:0},.95]]}),e.Velocity.RegisterEffect("rstbox.slideLeftOut",{defaultDuration:450,calls:[[{translateX:"-100%"},.95],[{opacity:0},.05]]}),e.Velocity.RegisterEffect("rstbox.slideRightIn",{defaultDuration:450,calls:[[{translateX:"100%",opacity:1},.05],[{translateX:0},.95]]}),e.Velocity.RegisterEffect("rstbox.slideRightOut",{defaultDuration:450,calls:[[{translateX:"100%"},.95],[{opacity:0},.05]]}))}(jQuery);
